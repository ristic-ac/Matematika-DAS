---
title: 'Екстракција правила из *ML* модела (*Aleph ILP*)'
author: 'Бранислав Ристић'
---

## Основне информације

- Име и презиме: Бранислав Ристић  
- Индекс: DP 8/2024  
- Е-пошта: <branislav.ristic@uns.ac.rs>
- Студијски програм: Рачунарство и аутоматика  
- Предмет: Одабрана поглавља из математике 1 и 2  
- Ментор: проф. др Душан Гајић  
- Факултет: Факултет техничких наука, Универзитет у Новом Саду

## Увод

- Циљ: дестилација модела „црних кутија” у **логичка правила** (објашњивост).
- Употреба: аудит, транспарентност, једноставнија валидација, регулаторна усклађеност.
- Скупoви: ***Mushroom*** и ***Adult***.
- Имплементација се налази на:
  - <https://github.com/ristic-ac/Matematika-DAS>

## Зашто интерпретабилност?

- У осетљивим доменима **објашњење** је неопходно.
  - Медицина
  - Финансије
  - Право
- Правила су **читљива** и **аудитабилна**.
- Помоћ у откривању **приступа** и **пристраности**.

## Идеја: Учитељ → Студент

- Учитељ: *DT / RF / XGB* → даје предикције.
- Студент: **ILP Aleph** (Пролог) → индукција правила која имитирају учитеља.
- Метрике: **фиделитет** (према учитељу) и **тачност** (према истини).

## Подаци

- ***Mushroom***: бинарне класе, номинални атрибути.
- ***Adult***: мешовити атрибути, циљ >50К.
- Балансирање класа + дискретизација нумеричких вредности.

## Учитељи (*DT / RF / XGB*)

- **DT**: једноставан, варијабилан.
- **RF**: ансамбл метода → стабилнији.
- **XGB**: градијентни бустинг → још бољи.

## Обрада и евалуација

- Поступак: **баланс → дискретизација → обука (CV)**.
- Тјунинг: *grid-search* + **5-fold**.
- Метрике: **Accuracy**, **Fidelity**, Precision, Recall, F1, MCC.

## Пролог

- Логички (декларативни) програмски језик.
- Чињенице, правила, упити.
- **Чињеница**: тврђење које је увек тачно.  
    Пример: `parent(john, mary).` (Џон је родитељ Мери)
- **Правило**: дефинише однос на основу других чињеница/правила.  
    Пример: `ancestor(X, Y) :- parent(X, Y).` (X је предак Y ако је X родитељ Y)
- **Упит**: питање за Пролог, проверава да ли је нешто тачно или тражи вредности.  
    Пример: `?- ancestor(john, mary).`

## Aleph ILP

- Индуктивно логичко програмирање (ILP).
- Библиотека за Пролог.
- Улаз: позитивни/негативни примери + **BK** + **bias** (modeh/modeb).
- Кораци: избор позитивног → **bottom** клауза → генерализације → најбоље правило.
- Итерација док се не покрије класа/не испуни критеријум.

## Пресети дестилације

- **sniper**: специфична правила, висока прецизност.
- **sweet_spot**: баланс прецизност/покривеност.
- **sweeper**: шира покривеност, мања сложеност.

## Резултати — *Mushroom*

- **Високе метрике** уз **мало правила**.
  - Фиделитет: 95%-100%.
  - Тачност: 95%-100%.
- Правила једноставна и интерпретабилна.
- Стабилност кроз пресете.
- Мала комплексност, перформансе високе.
- Пример правила (100% прецизност):

```
poisonous(A) :- odor(A, foul).
poisonous(A) :- gill_size(A, narrow).
```

## Резултати — *Adult*

- Често **фиделитет > тачност**.
  - Фиделитет: 70%-80%.
  - Тачност: 70%-75%.
- Ансамбли (*RF/XGB*) → стабилнији дестилати од *DT*.
- Компромис: сложеност ↔ добитак у метрикама.
- Пример правила (100% прецизност):

```
gt_50K(A) :- education(A, bachelors), 
    marital_status(A, married_civ_spouse), 
    hours_per_week(A, 41_60).

gt_50K(A) :- marital_status(A, married_civ_spouse), 
    education(A, advanced_degree).
```

## Практични савети

- Кључно: `search`, `evalfn`, `clauselength`, `minacc`, `nodes`.
- Дискретизација **пре** обуке; пазити на експлозију претраге.
- Пратити **coverage**, број правила и дужину тела.
- Оптимизовати према мерама од интереса.
- Поновити са различитим пресетима.

## Закључак

- *Aleph ILP* успешно дестилује моделе у **читљива правила**.
- *Mushroom*: веома успешан; *Adult*: израженији компромиси.
- Примена: аудитабилни системи, компактна и транспарентна логика.
- Потенцијалне будуће студије:
  - Други ILP алати.
  - Проширење на друге моделе учења.
  - Комбинација са другим техникама.
