---
title: 'Екстракција правила из *ML* модела (*Aleph ILP*)'
author: |
  Бранислав Ристић (DP 8/2024)
shortauthor: "Ристић"
institute: 'Факултет техничких наука, Универзитет у Новом Саду'
date: '01.10.2025.'
header-includes:
# Следеће линије су потребне за лого на главној страни и у горњем десном углу
  - \usepackage{graphicx}
  - \newcommand{\FTNLogo}{./images/ftn-logo.eps}
  - \titlegraphic{\includegraphics[height=1.8cm]{\FTNLogo}}
  - |
    \setbeamertemplate{logo}{\ifnum\thepage>1\raisebox{6.1cm}[0pt][0pt]{\makebox[\paperwidth][r]{\includegraphics[height=1.3cm]{\FTNLogo}\hspace{0cm}}}\fi}
# Наредне линије омогућавају "анимације" у *Beamer*-у
  - \usepackage{etoolbox}
  - \beamerdefaultoverlayspecification{<+->}
  - \newcounter{itemizeDepth}
  - \pretocmd{\itemize}{\stepcounter{itemizeDepth}\ifnum\value{itemizeDepth}=1\pause\fi}{}{}
  - \apptocmd{\enditemize}{\addtocounter{itemizeDepth}{-1}}{}{}
  - \newcounter{enumerateDepth}
  - \pretocmd{\enumerate}{\stepcounter{enumerateDepth}\ifnum\value{enumerateDepth}=1\pause\fi}{}{}
  - \apptocmd{\endenumerate}{\addtocounter{enumerateDepth}{-1}}{}{}
---

# Увод

## Сервисне информације

- Е-пошта: <branislav.ristic@uns.ac.rs>
- Студијски програм: Рачунарство и аутоматика  
- Предмет: Одабрана поглавља из математике 1 и 2  
- Саветник: проф. др Душан Гајић  
- Имплементација се налази на:
  - <https://github.com/ristic-ac/Matematika-DAS>

## Мотивација, циљ и разлози интерпретабилности

- Сложени модели су веома тачни, али им недостају објашњења.
- **Циљ:** дестилација модела „црних кутија” у **логичка правила**.
- **Зашто:**
  - У осетљивим доменима објашњење је неопходно (медицина, финансије, право).
  - Правила су **читљива** и **аудитабилна**, подстичу **транспарентност**.
  - Олакшавају **валидацију** и **регулаторну усклађеност**.

# Приступ и алати

## Идеја: Учитељ → Студент

- Учитељ: *DT / RF / XGB* → даје предикције.
- Студент: ***ILP Aleph*** (*Prolog*) → индукција правила која имитирају учитеља.
- Метрике:
  - **фиделитет** (усаглашеност са учитељем)
  - **тачност** (усаглашеност са истином).
- **Напомена**: резултати приказани у раду се односе на **тест скуп**.

## *Prolog*

- Логички (декларативни) програмски језик.
- Чињенице, правила, упити.
- **Чињеница**: тврђење које је увек тачно.  
  - Пример: `parent(john, mary).`
- **Правило**: дефинише однос на основу других чињеница/правила.  
  - Пример: `ancestor(X, Y) :- parent(X, Y).`
- **Упит**: питање за *Prolog*, проверава да ли је нешто тачно или тражи вредности.  
  - Пример: `?- ancestor(john, mary).`

## *Aleph ILP*

- Библиотека за *Prolog*.
- Индуктивно логичко програмирање (*ILP*).
- Ради над категоричким (дискретним) подацима.
- Улаз: позитивни/негативни примери + ***BK*** + ***bias*** (`modeh`/`modeb`).
- Излаз: **скуп правила који покривају позитивне, и потенцијално неке негативне примере**.

# Подаци и модели

## Подаци

- Два јавна скупа података:
  - ***Mushroom***: номинални атрибути.
    - Предвиђање отровности печурака.
  - ***Adult***: мешовити атрибути (неопходна дискретизација).
    - Предвиђање прихода по особи (>50k/<=50k).
- Доступни на *UCI ML* репозиторијуму.

## Учитељи (*DT / RF / XGB*)

- **DT**: једноставан, варијабилан.
- **RF**: ансамбл метода → стабилнији, али мање интерпретабилан.
- **XGB**: градијентни бустинг → још боље перформансе, већа сложеност.

# Поступак и подешавања

## Обрада и евалуација

- Поступак: **чишћење → баланс → дискретизација → обука (CV)**.
- Подела: 85% обука, 15% тест.
- Оптимизација хиперпараметара: **grid-search** + **5-fold**.
  - Циљна метрика: тачност.
- Кумулативна важност обележја:  
  - Задржана су обележја са укупном важности $\geq 0.9$ (на основу модела учитеља).
    - Смањује простор претраге за Aleph.

## Успешност модела

- Тачност модела на тест скупу:

| Скуп података |   DT  |    RF     |     XGB |
|---------------|-------|-----------|---------|
| **Mushroom**  | ~99.1% | **100.0%** | ~99.2%  |
| **Adult**     | ~80.7% | ~81.5%    |**~82.3%**|

## Пресети дестилације

- Пресети диктирају стратегију претраге правила.
  - Утичу на број и квалитет правила.
- 3 пресета:
  - **sniper**: специфична правила, висока прецизност.
  - **sweet_spot**: баланс прецизност/покривеност.
  - **sweeper**: шира покривеност, мања сложеност.

## Практични савети за Aleph

- Кључно: `search`, `evalfn`, `clauselength`, `minacc`, `nodes`.
- Дискретизација **пре** обуке.
- Пратити **coverage**, број правила и дужину тела.
- Оптимизовати према мерама од интереса.
- Поновити са различитим пресетима.

# Резултати дестилације

## Резултати дестилације — *Mushroom*

- **Високе тест метрике** уз **мало правила**.
  - Фиделитет: 95%-100%.
  - Тачност: 95%-100%.
- Правила једноставна и интерпретабилна.
- Стабилност кроз пресете.
- Максимум перформанси већ са 6–8 правила.

## Пример правила - *Mushroom*

```
% support: 322, coverage: 0.5589, precision: 1.0000
poisonous(A) :- odor(A, foul).

% support: 265, coverage: 0.4514, precision: 1.0000
poisonous(A) :- gill_color(A, buff).
```

## Резултати дестилације — *Adult*

- Често **тест фиделитет > тачност**.
  - Фиделитет: 70%-80%.
  - Тачност: 70%-75%.
  - Претпоставка: већа варијабилност података → несавршени учитељи.
- Ансамбли (*RF/XGB*) → стабилнији дестилати од *DT*.
- Компромис: сложеност ↔ добитак у метрикама.
  - *sweet_spot*: мање правила од *sniper*, сличан квалитет.
  - *sweeper*: најмање правила, пад тачности.

## Пример правила - *Adult*

```
% support: 484, coverage: 0.2614, precision: 0.9814
gt_50K(A) :- education(A, bachelors), 
  marital_status(A, married_civ_spouse).   

% support: 408, coverage: 0.1987, precision: 0.8848
gt_50K(A) :- education(A, advanced_degree)
```

# Закључак и будући рад

## Закључак

- *Aleph ILP* успешно дестилује моделе у **читљива правила**.
  - *Mushroom*:
    - лако раздвојив скуп,
    - веома успешни дестилати.
  - *Adult*:
    - варијабилнији подаци,
    - израженији компромиси.

## Потенцијалне будуће студије

- Други *ILP* алати.
- Проширење на друге моделе учења.
- Комбинација са другим техникама.
- Алтернативни редослед претпроцесирања.
